FROM hokiegeek2/udp-arkouda-server-base:0.0.1

ADD src/ /opt/src
ADD Makefile /opt/Makefile
ADD dep/ /opt/dep
ADD VERSION /opt/VERSION
WORKDIR /opt
USER root

ADD start-arkouda-server.sh /opt/start-arkouda-server.sh
RUN chown -R ubuntu:ubuntu /opt/

USER ubuntu

ARG SSH_SERVERS=${SSH_SERVERS}
ARG GASNET_MASTERIP=${GASNET_MASTERIP}
ENV SSH_SERVERS=${SSH_SERVERS}
ENV GASNET_MASTERIP=${GASNET_MASTERIP}

RUN make install-deps
RUN make

EXPOSE 5555
EXPOSE 5000-65000/udp

